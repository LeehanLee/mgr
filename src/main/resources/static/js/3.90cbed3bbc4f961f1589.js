webpackJsonp([3],{a167:function(e,t){},gh42:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=r("lk5p"),n={created:function(){window.ListService.get(this.listUrl,{vm:this}).then(this.handleListDataReceived)},data:function(){return{formLabelWidth:"200px",dtoFormVisible:!1,currentDto:{enabled:!1},rules:{dtoname:[{required:!0,message:"请输入权限名",trigger:"change"},{min:2,max:16,message:"长度在 2 到 16 个字符",trigger:"change"}]},currentIndex:-1,message:"",treeData:[]}},methods:{handleSubmitClick:function(e,t){var r=this,n=this;this.$refs.ruleForm.validate(function(e){if(!e)return r.$message({message:"请处理完错误后再保存",type:"error"}),!1;n.currentDto.id?window.ActionService.post("/api/right/update",r.currentDto,{successMsg:"保存成功",errorMsg:"保存失败"}).then(function(e){var t=Object(a.c)(n.treeData,n.currentDto.id);t.enabled=n.currentDto.enabled,t.label=n.currentDto.name,n.dtoFormVisible=!1}):window.ActionService.post("/api/right/insert",n.currentDto,{successMsg:"添加成功",errorMsg:"添加失败"}).then(function(e){n.dtoFormVisible=!1,window.ListService.get(n.listUrl,{vm:r}).then(n.handleListDataReceived)})})},handleListDataReceived:function(e){this._.isEmpty(e.rows)&&(this.message="暂无数据"),this.treeData=Object(a.b)(e.rows.map(function(e){return e.enabled=!0,e}))},showAddingForm:function(e){this.dtoFormVisible=!0,this.currentDto={parentid:e?e.value:null,parentname:e?e.label:"无"}},handleEditClick:function(e,t){this.dtoFormVisible=!0,this.currentDto={parentid:e.parent?e.parent.data.value:null,parentname:e.parent?e.parent.data.label:"无",name:t.label,id:t.value,enabled:t.enabled}}},computed:{listUrl:function(){return"/api/right/getMyRights?page=1&pageSize=999999"},modelTitle:function(){return this.currentDto.id?"编辑权限":"添加权限"}}},i={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"main-content"},[r("el-breadcrumb",{attrs:{separator:"/"}},[r("el-breadcrumb-item",{staticClass:"other"},[e._v("权限管理")]),e._v(" "),r("el-breadcrumb-item",[e._v("权限列表")])],1),e._v(" "),r("div",{class:{"tree-container":!0,"right-tree":!0,"msg-container":!!e.message}},[e.message?r("div",{staticClass:"msg"},[e._v(e._s(e.message))]):r("div",{staticClass:"tree-area"},[r("el-tree",{ref:"rightTree",attrs:{data:e.treeData,"node-key":"id","check-strictly":!0,"default-expand-all":"","expand-on-click-node":!1},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.node,n=t.data;return r("span",{staticClass:"custom-tree-node"},[r("span",{class:n.enabled?"item-enabled":"item-disabled"},[e._v(e._s(n.label+(n.enabled?"":"(已禁用)")))]),e._v(" "),r("span",[r("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(t){e.handleEditClick(a,n)}}},[e._v("编辑")])],1)])}}])})],1)]),e._v(" "),r("el-dialog",{attrs:{modal:!1,title:e.modelTitle,visible:e.dtoFormVisible},on:{"update:visible":function(t){e.dtoFormVisible=t}}},[r("el-form",{ref:"ruleForm",attrs:{model:e.currentDto,rules:e.rules}},[e.currentDto.parentid?r("el-form-item",{attrs:{label:"上级权限","label-width":e.formLabelWidth,prop:"name"}},[r("span",[e._v(e._s(e.currentDto.parentname))])]):e._e(),e._v(" "),r("el-form-item",{attrs:{label:"权限名","label-width":e.formLabelWidth,prop:"name"}},[r("el-input",{attrs:{autocomplete:"off"},model:{value:e.currentDto.name,callback:function(t){e.$set(e.currentDto,"name",t)},expression:"currentDto.name"}})],1)],1),e._v(" "),r("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{attrs:{type:"primary"},on:{click:e.handleSubmitClick}},[e._v("确定")]),e._v(" "),r("el-button",{on:{click:function(t){e.dtoFormVisible=!1}}},[e._v("取消")])],1)],1)],1)},staticRenderFns:[]};var s=r("VU/8")(n,i,!1,function(e){r("a167")},null,null);t.default=s.exports}});