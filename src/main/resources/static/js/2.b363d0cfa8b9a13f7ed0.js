webpackJsonp([2],{"8xfg":function(e,t,n){"use strict";var r={props:{msg:String,columns:Array,rows:Array,actions:Array,costmerStyle:Object},data:function(){return{selectedByIndex:[]}},methods:{getContainerClass:function(){var e="table-container";return(this.msg||!this.rows||this.rows.length<=0)&&(e+=" no-data-container"),e},allSelectedChange:function(e){this.selectedByIndex=this.rows.map(function(t){return e})},getSelectedIds:function(){var e=this,t=[];return this.selectedByIndex.forEach(function(n,r){n&&t.push(e.rows[r].id)}),t}},computed:{actionsColumnWidth:function(){return{width:this.actions.reduce(function(e,t){return(t.width?t.width:70)+e},0)+"px"}}}},i={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{key:JSON.stringify(e.rows),class:e.getContainerClass(),style:e.costmerStyle},[e.msg?n("div",{staticClass:"no-data"},[e._v(e._s(e.msg))]):!e.rows||e.rows.length<=0?n("div",{staticClass:"no-data"},[e._v("Sorry, no data yet.")]):n("table",{staticClass:"basic-table"},[n("thead",[n("tr",{staticClass:"title"},[n("th",{staticClass:"selected-column"},[n("el-checkbox",{staticClass:"select",on:{change:e.allSelectedChange}})],1),e._v(" "),e._l(e.columns,function(t,r){return n("th",{key:r},[e._v(e._s(t.text))])}),e._v(" "),e.actions&&e.actions.length>0?n("th",{style:e.actionsColumnWidth},[e._v("操作")]):e._e()],2)]),e._v(" "),n("tbody",e._l(e.rows,function(t,r){return n("tr",{key:r,staticClass:"row"},[n("td",{staticClass:"selected-column"},[n("el-checkbox",{staticClass:"select",model:{value:e.selectedByIndex[r],callback:function(t){e.$set(e.selectedByIndex,r,t)},expression:"selectedByIndex[rindex]"}})],1),e._v(" "),e._l(e.columns,function(r,i){return n("td",{key:i,style:r.style?r.style(t.enabled):""},[e._v(e._s(r.render?r.render(t[r.dataIndex]):t[r.dataIndex]))])}),e._v(" "),e.actions&&e.actions.length>0?n("td",e._l(e.actions,function(r,i){return n("el-button",{key:i,attrs:{size:"small",type:"primary"},on:{click:function(e){r.handleClick(t)}}},[e._v(e._s(r.text))])}),1):e._e()],2)}),0)])])},staticRenderFns:[]};var a=n("VU/8")(r,i,!1,function(e){n("UeeO")},null,null);t.a=a.exports},Ntkv:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n("8xfg"),i=n("PJh5"),a=n.n(i),s=n("lk5p"),o={components:{Table:r.a},created:function(){window.ListService.get(this.listUrl,{vm:this}).then(this.handleListDataReceived)},watch:{dtoFormVisible:function(e,t){var n=this;e&&(this._.isEmpty(this.roleList)&&window.BaseHttpService.get("/api/role/getList").then(function(e){n.roleList=e.rows.filter(function(e){return e.enabled})}),this._.isEmpty(this.orgList)?window.BaseHttpService.get("/api/org/getList?page=1&pageSize=10000").then(function(e){n.orgList=e.rows,n.selectedOrgIdPath=Object(s.a)(n.orgList,n.currentDto.orgid),n.orgTree=Object(s.b)(e.rows.filter(function(e){return e.enabled}))}):n.selectedOrgIdPath=Object(s.a)(n.orgList,n.currentDto.orgid))},selectedOrgIdPath:function(e,t){this.currentDto.orgid=e[e.length-1]}},data:function(){return{selectedOrgIdPath:[],orgTree:[],orgList:[],roleList:[],currentPage:1,pageSize:20,total:0,formLabelWidth:"200px",dtoFormVisible:!1,count:0,currentDto:{},rules:{username:[{required:!0,message:"请输入用户名",trigger:"change"},{min:2,max:16,message:"长度在 2 到 16 个字符",trigger:"change"}],password:[{required:!0,message:"请输入密码",trigger:"change"},{min:6,max:16,message:"长度在 6 到 16 个字符",trigger:"change"}],mobile:[{required:!0,message:"请输入电话号码",trigger:"change"},{min:6,max:12,message:"长度在 6 到 12 个字符",trigger:"change"}],orgid:[{required:!0,message:"请选择组织",trigger:"change"}],roleid:[{required:!0,message:"请选择角色",trigger:"change"}],gender:[{required:!0,message:"请选择性别",trigger:"change"}]},currentIndex:-1,userColumns:[{text:"用户名",dataIndex:"username"},{text:"密码",dataIndex:"password"},{text:"电话",dataIndex:"mobile"},{text:"组织",dataIndex:"orgName"},{text:"角色",dataIndex:"roleName"},{text:"添加日期",dataIndex:"created",render:function(e){return a()(e).format("YYYY-MM-DD")}},{text:"启用",dataIndex:"enabled",render:function(e){return e?"启用":"禁用"},style:function(e){return{color:e?"blue":"red"}}}],loadingMsg:"",listData:[]}},methods:{handleSubmitClick:function(e,t){var n=this,r=this;this.$refs.ruleForm.validate(function(e){if(!e)return n.$message({message:"请处理完错误后再保存",type:"error"}),!1;r.currentDto.id?window.ActionService.post("/api/account/update",n.currentDto,{successMsg:"保存成功",errorMsg:"保存失败"}).then(function(e){r.currentDto.orgName=r.orgList.find(function(e){return e.id===r.currentDto.orgid}).name,r.listData.splice(r.currentIndex,1,r.currentDto),r.dtoFormVisible=!1}):window.ActionService.post("/api/account/insert",r.currentDto,{successMsg:"添加成功",errorMsg:"添加失败"}).then(function(e){r.dtoFormVisible=!1,r.currentPage=1,window.ListService.get(r.listUrl,{vm:n}).then(r.handleListDataReceived)})})},handlePageSizeChange:function(e){this.currentPage=1,this.pageSize=e,window.ListService.get(this.listUrl,{vm:this}).then(this.handleListDataReceived)},handleListDataReceived:function(e){this.listData=e.rows,this.currentPage=e.page,this.pageSize=e.pageSize,this.total=e.total},handlePageChange:function(e){this.currentPage=e,window.ListService.get(this.listUrl,{vm:this}).then(this.handleListDataReceived)},showAddingForm:function(){this.dtoFormVisible=!0,this.currentDto={}},handleToggleEnableClick:function(e){var t=this.$refs.table.getSelectedIds();if(this._.isEmpty(t))return this.$message({message:"请先勾选要"+(e?"启":"禁")+"用的用户",type:"error"}),!1;var n=t.join(","),r="/api/account/"+(e?"enable":"disable");window.ToggleEnableAndAlert(this,r,n,null,e)},getPageButtonFunc:function(e){switch(e){case"account/insert":return this.showAddingForm();case"account/enable":return this.handleToggleEnableClick(!0);case"account/disable":return this.handleToggleEnableClick(!1)}},getItemButtonFunc:function(e){var t=this;switch(e){case"account/update":return function(e){t.currentDto=t._.assign({},e),t.dtoFormVisible=!0,t.currentIndex=t._.findIndex(t.listData,function(n){return t._.isEqual(n,e)})};case"account/enable":return this.getToggleEnableAndAlertFunc(t,!0);case"account/disable":return this.getToggleEnableAndAlertFunc(t,!1);case"account/delete":return function(e){var n="/api/account/delete?id="+e.id;window.HandleDeleteClick(t,n)}}},getToggleEnableAndAlertFunc:function(e,t){return function(n){var r="/api/account/"+(t?"enable":"disable");window.ToggleEnableAndAlert(e,r,n.id,n,t)}}},computed:{listUrl:function(){return"/api/account/getList?page="+this.currentPage+"&pageSize="+this.pageSize},modalTitle:function(){return this._.isEmpty(this.currentDto)?"添加用户":"编辑用户"},pageRights:function(){return Object(s.e)(this.$store,"account")},itemRights:function(){var e=this;return Object(s.d)(this.$store,"account").map(function(t){return{text:t.name,handleClick:e.getItemButtonFunc(t.id)}})},containerHeight:function(){return{height:this._.isEmpty(this.pageRights)?"calc(100% - 212px)":"calc(100% - 270px)"}}}},l={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"main-content"},[n("el-breadcrumb",{attrs:{separator:"/"}},[n("el-breadcrumb-item",{staticClass:"other"},[e._v("用户管理")]),e._v(" "),n("el-breadcrumb-item",[e._v("用户列表")])],1),e._v(" "),n("el-row",e._l(e.pageRights,function(t,r){return n("el-button",{key:r,attrs:{type:"primary",size:"small"},on:{click:function(n){e.getPageButtonFunc(t.id)}}},[e._v(e._s(t.name))])}),1),e._v(" "),n("div",{staticClass:"data-content"},[n("Table",{ref:"table",attrs:{msg:e.loadingMsg,rows:e.listData,columns:e.userColumns,actions:e.itemRights,costmerStyle:e.containerHeight}}),e._v(" "),n("el-pagination",{attrs:{"current-page":e.currentPage,"page-sizes":[10,20,50,100],"page-size":e.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"size-change":e.handlePageSizeChange,"current-change":e.handlePageChange}})],1),e._v(" "),n("el-dialog",{attrs:{modal:!1,title:e.modalTitle,visible:e.dtoFormVisible},on:{"update:visible":function(t){e.dtoFormVisible=t}}},[n("el-form",{ref:"ruleForm",attrs:{model:e.currentDto,rules:e.rules}},[n("el-form-item",{attrs:{label:"用户名","label-width":e.formLabelWidth,prop:"username"}},[n("el-input",{attrs:{autocomplete:"off"},model:{value:e.currentDto.username,callback:function(t){e.$set(e.currentDto,"username",t)},expression:"currentDto.username"}})],1),e._v(" "),n("el-form-item",{attrs:{label:"密码","label-width":e.formLabelWidth,prop:"password"}},[n("el-input",{attrs:{autocomplete:"off"},model:{value:e.currentDto.password,callback:function(t){e.$set(e.currentDto,"password",t)},expression:"currentDto.password"}})],1),e._v(" "),n("el-form-item",{attrs:{label:"电话","label-width":e.formLabelWidth,prop:"mobile"}},[n("el-input",{attrs:{autocomplete:"off"},model:{value:e.currentDto.mobile,callback:function(t){e.$set(e.currentDto,"mobile",t)},expression:"currentDto.mobile"}})],1),e._v(" "),n("el-form-item",{attrs:{label:"组织","label-width":e.formLabelWidth,prop:"orgid"}},[n("el-cascader",{attrs:{placeholder:"输入即可搜索","show-all-levels":!1,"change-on-select":!0,"expand-trigger":"hover",options:e.orgTree,filterable:""},model:{value:e.selectedOrgIdPath,callback:function(t){e.selectedOrgIdPath=t},expression:"selectedOrgIdPath"}})],1),e._v(" "),n("el-form-item",{attrs:{prop:"roleid",label:"角色","label-width":e.formLabelWidth}},[n("el-select",{attrs:{placeholder:"请选择角色"},model:{value:e.currentDto.roleid,callback:function(t){e.$set(e.currentDto,"roleid",t)},expression:"currentDto.roleid"}},e._l(e.roleList,function(e){return n("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}),1)],1),e._v(" "),n("el-form-item",{attrs:{label:"","label-width":e.formLabelWidth,prop:"enabled"}},[n("el-checkbox",{model:{value:e.currentDto.enabled,callback:function(t){e.$set(e.currentDto,"enabled",t)},expression:"currentDto.enabled"}},[e._v("启用")])],1)],1),e._v(" "),n("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{attrs:{type:"primary"},on:{click:e.handleSubmitClick}},[e._v("确定")]),e._v(" "),n("el-button",{on:{click:function(t){e.dtoFormVisible=!1}}},[e._v("取消")])],1)],1)],1)},staticRenderFns:[]};var c=n("VU/8")(o,l,!1,function(e){n("oT85")},null,null);t.default=c.exports},UeeO:function(e,t){},oT85:function(e,t){}});
//# sourceMappingURL=2.b363d0cfa8b9a13f7ed0.js.map