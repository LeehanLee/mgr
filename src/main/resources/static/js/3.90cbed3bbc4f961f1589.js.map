{"version":3,"sources":["webpack:///src/views/admin/right.vue","webpack:///./src/views/admin/right.vue?8ff7","webpack:///./src/views/admin/right.vue"],"names":["right","created","window","ListService","get","this","listUrl","vm","then","handleListDataReceived","data","formLabelWidth","dtoFormVisible","currentDto","enabled","rules","dtoname","required","message","trigger","min","max","currentIndex","treeData","methods","handleSubmitClick","e","e2","_this","self","$refs","validate","valid","$message","type","id","ActionService","post","successMsg","errorMsg","r","target","Object","Utils","label","name","result","_","isEmpty","rows","map","showAddingForm","parent","parentid","value","parentname","handleEditClick","node","computed","modelTitle","admin_right","render","_vm","_h","$createElement","_c","_self","staticClass","attrs","separator","_v","class","tree-container","right-tree","msg-container","_s","ref","node-key","check-strictly","default-expand-all","expand-on-click-node","scopedSlots","_u","key","fn","size","on","click","$event","modal","title","visible","update:visible","model","label-width","prop","_e","autocomplete","callback","$$v","$set","expression","slot","staticRenderFns","Component","__webpack_require__","normalizeComponent","ssrContext","__webpack_exports__"],"mappings":"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","file":"js/3.90cbed3bbc4f961f1589.js","sourcesContent":["<template>\r\n  <div class=\"main-content\">\r\n    <el-breadcrumb separator=\"/\">\r\n      <el-breadcrumb-item class=\"other\">权限管理</el-breadcrumb-item>\r\n      <el-breadcrumb-item>权限列表</el-breadcrumb-item>\r\n    </el-breadcrumb>\r\n    <div :class=\"{'tree-container': true, 'right-tree': true, 'msg-container': !!message}\">\r\n      <div v-if=\"message\" class=\"msg\">{{message}}</div>\r\n      <div v-else class=\"tree-area\">\r\n        <el-tree\r\n          :data=\"treeData\"\r\n          node-key=\"id\"\r\n          :check-strictly=\"true\"\r\n          ref=\"rightTree\"\r\n          default-expand-all\r\n          :expand-on-click-node=\"false\"\r\n        >\r\n          <span class=\"custom-tree-node\" slot-scope=\"{ node, data }\">\r\n            <span\r\n              :class=\"data.enabled ? 'item-enabled': 'item-disabled'\"\r\n            >{{ `${data.label}${!data.enabled ? '(已禁用)':''}` }}</span>\r\n            <span>\r\n              <!-- <el-button type=\"text\" size=\"mini\" @click=\"showAddingForm(data)\">添加下级权限</el-button> -->\r\n              <el-button type=\"text\" size=\"mini\" @click=\"handleEditClick(node, data)\">编辑</el-button>\r\n              <!-- <el-button\r\n                class=\"delete-btn\"\r\n                v-if=\"!data.children || data.children.length <= 0\"\r\n                type=\"text\"\r\n                size=\"mini\"\r\n                @click=\"handleRemoveClick(node, data)\"\r\n              >删除</el-button>-->\r\n            </span>\r\n          </span>\r\n        </el-tree>\r\n      </div>\r\n    </div>\r\n    <el-dialog :modal=\"false\" :title=\"modelTitle\" :visible.sync=\"dtoFormVisible\">\r\n      <el-form :model=\"currentDto\" :rules=\"rules\" ref=\"ruleForm\">\r\n        <el-form-item\r\n          v-if=\"currentDto.parentid\"\r\n          label=\"上级权限\"\r\n          :label-width=\"formLabelWidth\"\r\n          prop=\"name\"\r\n        >\r\n          <span>{{currentDto.parentname}}</span>\r\n        </el-form-item>\r\n        <el-form-item label=\"权限名\" :label-width=\"formLabelWidth\" prop=\"name\">\r\n          <el-input v-model=\"currentDto.name\" autocomplete=\"off\"></el-input>\r\n        </el-form-item>\r\n        <!-- <el-form-item label :label-width=\"formLabelWidth\" prop=\"enabled\">\r\n          <el-checkbox v-model=\"currentDto.enabled\">启用</el-checkbox>\r\n        </el-form-item>-->\r\n      </el-form>\r\n      <div slot=\"footer\" class=\"dialog-footer\">\r\n        <el-button type=\"primary\" @click=\"handleSubmitClick\">确定</el-button>\r\n        <el-button @click=\"dtoFormVisible = false\">取消</el-button>\r\n      </div>\r\n    </el-dialog>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { buildTree, findFromTree } from \"../../common/Utils\";\r\nexport default {\r\n  created() {\r\n    window.ListService.get(this.listUrl, { vm: this }).then(\r\n      this.handleListDataReceived\r\n    );\r\n  },\r\n  data: function() {\r\n    return {\r\n      formLabelWidth: \"200px\",\r\n      dtoFormVisible: false,\r\n      currentDto: { enabled: false },\r\n      rules: {\r\n        dtoname: [\r\n          { required: true, message: \"请输入权限名\", trigger: \"change\" },\r\n          {\r\n            min: 2,\r\n            max: 16,\r\n            message: \"长度在 2 到 16 个字符\",\r\n            trigger: \"change\"\r\n          }\r\n        ]\r\n      },\r\n      currentIndex: -1,\r\n      message: \"\",\r\n      treeData: []\r\n    };\r\n  },\r\n  methods: {\r\n    handleSubmitClick: function(e, e2) {\r\n      const self = this;\r\n      this.$refs[\"ruleForm\"].validate(valid => {\r\n        if (valid) {\r\n          if (self.currentDto.id) {\r\n            window.ActionService.post(\"/api/right/update\", this.currentDto, {\r\n              successMsg: \"保存成功\",\r\n              errorMsg: \"保存失败\"\r\n            }).then(r => {\r\n              const target = findFromTree(self.treeData, self.currentDto.id);\r\n              target.enabled = self.currentDto.enabled;\r\n              target.label = self.currentDto.name;\r\n              self.dtoFormVisible = false;\r\n            });\r\n          } else {\r\n            window.ActionService.post(\"/api/right/insert\", self.currentDto, {\r\n              successMsg: \"添加成功\",\r\n              errorMsg: \"添加失败\"\r\n            }).then(r => {\r\n              self.dtoFormVisible = false;\r\n              window.ListService.get(self.listUrl, { vm: this }).then(\r\n                self.handleListDataReceived\r\n              );\r\n            });\r\n          }\r\n        } else {\r\n          this.$message({ message: \"请处理完错误后再保存\", type: \"error\" });\r\n          return false;\r\n        }\r\n      });\r\n    },\r\n    handleListDataReceived: function(result) {\r\n      if (this._.isEmpty(result.rows)) {\r\n        this.message = \"暂无数据\";\r\n      }\r\n      this.treeData = buildTree(\r\n        result.rows.map(r => {\r\n          r.enabled = true;\r\n          return r;\r\n        })\r\n      );\r\n    },\r\n    showAddingForm: function(parent) {\r\n      this.dtoFormVisible = true;\r\n      this.currentDto = {\r\n        parentid: parent ? parent.value : null,\r\n        parentname: parent ? parent.label : \"无\"\r\n      };\r\n    },\r\n    handleEditClick: function(node, data) {\r\n      this.dtoFormVisible = true;\r\n      this.currentDto = {\r\n        parentid: node.parent ? node.parent.data.value : null,\r\n        parentname: node.parent ? node.parent.data.label : \"无\",\r\n        name: data.label,\r\n        id: data.value,\r\n        enabled: data.enabled\r\n      };\r\n    }\r\n    // handleRemoveClick: function(node, data) {\r\n    //   const url = `/api/right/delete?id=${data.value}`;\r\n    //   window.HandleDeleteClick(this, url);\r\n    // },\r\n    // handleToggleEnableClick: function(enabled) {\r\n    //   const selectedNodes = this.$refs.rightTree.getCheckedNodes().map(node => {\r\n    //     return node.value;\r\n    //   });\r\n    //   if (this._.isEmpty(selectedNodes)) {\r\n    //     this.$message({\r\n    //       message: `请先勾选要${enabled ? \"启\" : \"禁\"}用的权限`,\r\n    //       type: \"error\"\r\n    //     });\r\n    //     return false;\r\n    //   }\r\n    //   const ids = selectedNodes.join(\",\");\r\n    //   const url = `/api/right/updateStatus?ids=${ids}&enabled=${enabled}`;\r\n    //   window.ToggleEnableAndAlert(this, url, null, enabled);\r\n    // }\r\n  },\r\n  computed: {\r\n    listUrl: function() {\r\n      return `/api/right/getMyRights?page=1&pageSize=999999`;\r\n    },\r\n    modelTitle: function() {\r\n      return !this.currentDto.id ? \"添加权限\" : \"编辑权限\";\r\n    }\r\n  }\r\n};\r\n</script>\r\n<style lang=\"less\">\r\n.main-content {\r\n  margin: 10px 10px 10px 2.5%;\r\n\r\n  .right-tree {\r\n    height: calc(100% - 182px) !important;\r\n  }\r\n}\r\n</style>\r\n\n\n\n// WEBPACK FOOTER //\n// src/views/admin/right.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"main-content\"},[_c('el-breadcrumb',{attrs:{\"separator\":\"/\"}},[_c('el-breadcrumb-item',{staticClass:\"other\"},[_vm._v(\"权限管理\")]),_vm._v(\" \"),_c('el-breadcrumb-item',[_vm._v(\"权限列表\")])],1),_vm._v(\" \"),_c('div',{class:{'tree-container': true, 'right-tree': true, 'msg-container': !!_vm.message}},[(_vm.message)?_c('div',{staticClass:\"msg\"},[_vm._v(_vm._s(_vm.message))]):_c('div',{staticClass:\"tree-area\"},[_c('el-tree',{ref:\"rightTree\",attrs:{\"data\":_vm.treeData,\"node-key\":\"id\",\"check-strictly\":true,\"default-expand-all\":\"\",\"expand-on-click-node\":false},scopedSlots:_vm._u([{key:\"default\",fn:function(ref){\nvar node = ref.node;\nvar data = ref.data;\nreturn _c('span',{staticClass:\"custom-tree-node\"},[_c('span',{class:data.enabled ? 'item-enabled': 'item-disabled'},[_vm._v(_vm._s((\"\" + (data.label) + (!data.enabled ? '(已禁用)':''))))]),_vm._v(\" \"),_c('span',[_c('el-button',{attrs:{\"type\":\"text\",\"size\":\"mini\"},on:{\"click\":function($event){_vm.handleEditClick(node, data)}}},[_vm._v(\"编辑\")])],1)])}}])})],1)]),_vm._v(\" \"),_c('el-dialog',{attrs:{\"modal\":false,\"title\":_vm.modelTitle,\"visible\":_vm.dtoFormVisible},on:{\"update:visible\":function($event){_vm.dtoFormVisible=$event}}},[_c('el-form',{ref:\"ruleForm\",attrs:{\"model\":_vm.currentDto,\"rules\":_vm.rules}},[(_vm.currentDto.parentid)?_c('el-form-item',{attrs:{\"label\":\"上级权限\",\"label-width\":_vm.formLabelWidth,\"prop\":\"name\"}},[_c('span',[_vm._v(_vm._s(_vm.currentDto.parentname))])]):_vm._e(),_vm._v(\" \"),_c('el-form-item',{attrs:{\"label\":\"权限名\",\"label-width\":_vm.formLabelWidth,\"prop\":\"name\"}},[_c('el-input',{attrs:{\"autocomplete\":\"off\"},model:{value:(_vm.currentDto.name),callback:function ($$v) {_vm.$set(_vm.currentDto, \"name\", $$v)},expression:\"currentDto.name\"}})],1)],1),_vm._v(\" \"),_c('div',{staticClass:\"dialog-footer\",attrs:{\"slot\":\"footer\"},slot:\"footer\"},[_c('el-button',{attrs:{\"type\":\"primary\"},on:{\"click\":_vm.handleSubmitClick}},[_vm._v(\"确定\")]),_vm._v(\" \"),_c('el-button',{on:{\"click\":function($event){_vm.dtoFormVisible = false}}},[_vm._v(\"取消\")])],1)],1)],1)}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-8df1f254\",\"hasScoped\":false,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/views/admin/right.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-8df1f254\\\",\\\"scoped\\\":false,\\\"hasInlineConfig\\\":false}!less-loader?{\\\"sourceMap\\\":true}!../../../node_modules/vue-loader/lib/selector?type=styles&index=0!./right.vue\")\n}\nvar normalizeComponent = require(\"!../../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./right.vue\"\nimport __vue_script__ from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./right.vue\"\n/* template */\nimport __vue_template__ from \"!!../../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-8df1f254\\\",\\\"hasScoped\\\":false,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../../node_modules/vue-loader/lib/selector?type=template&index=0!./right.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = null\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/views/admin/right.vue\n// module id = null\n// module chunks = "],"sourceRoot":""}